# 이진 분류 머신러닝 전체 프로세스 플로우차트

## 전체 흐름도

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         1. 데이터 준비 (Data Preparation)                     │
├─────────────────────────────────────────────────────────────────────────────┤
│  binary.csv 로드 → [x1, x2, x3] 특성 + [y] 레이블 (0 또는 1)                  │
│                              ↓                                               │
│  train(80%) / validation(10%) / test(10%) 분할                              │
│                              ↓                                               │
│  DataLoader로 배치(batch) 단위로 묶기 (batch_size=64)                         │
└─────────────────────────────────────────────────────────────────────────────┘
                               ↓
┌─────────────────────────────────────────────────────────────────────────────┐
│                         2. 모델 정의 (Model Definition)                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   입력 [x1, x2, x3]  ──→  Linear(3→1)  ──→  Sigmoid  ──→  출력 (0~1)        │
│        (3개 특성)         (가중치 연산)      (활성화함수)     (확률값)          │
│                                                                              │
│   계산: output = sigmoid(w1*x1 + w2*x2 + w3*x3 + b)                         │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
                               ↓
┌─────────────────────────────────────────────────────────────────────────────┐
│                         3. 학습 루프 (Training Loop) × 10,000 epochs          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │  A. 순전파 (Forward Pass)                                             │   │
│  │     입력 x → 모델 → 예측값 output (0~1 사이 확률)                      │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                               ↓                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │  B. 손실 계산 (Loss Calculation)                                      │   │
│  │     BCELoss(output, y) → 예측이 정답과 얼마나 다른지 계산              │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                               ↓                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │  C. 역전파 (Backward Pass)                                            │   │
│  │     loss.backward() → 각 가중치가 손실에 미친 영향(기울기) 계산        │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                               ↓                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │  D. 가중치 업데이트 (Weight Update)                                   │   │
│  │     optimizer.step() → 기울기 방향으로 가중치 조정 (w = w - lr*grad)   │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│  → 이 과정을 반복하면서 손실(cost)이 점점 줄어듦                              │
└─────────────────────────────────────────────────────────────────────────────┘
                               ↓
┌─────────────────────────────────────────────────────────────────────────────┐
│                         4. 검증 (Validation)                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   검증 데이터 입력 → 모델 예측 → 0.5 기준으로 분류                            │
│                                                                              │
│   output >= 0.5  →  클래스 1 (True)                                         │
│   output <  0.5  →  클래스 0 (False)                                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 각 단계 상세 설명

### 1. Sigmoid 활성화 함수의 역할

```
         1.0 ┤                    ●●●●●●●●●
             │                 ●●●
             │               ●●
         0.5 ┤- - - - - - -●- - - - - - - -  ← 분류 기준선
             │            ●
             │          ●●
         0.0 ┤●●●●●●●●●●
             └────────────────────────────→
                        0        입력값
```

| 역할 | 설명 |
|------|------|
| **출력 범위 제한** | 어떤 입력이든 0~1 사이 값으로 변환 |
| **확률 해석** | 출력값을 "클래스 1일 확률"로 해석 가능 |
| **미분 가능** | 역전파 시 기울기 계산 가능 |

---

### 2. BCELoss (Binary Cross Entropy)의 역할

```
손실 = -[y × log(output) + (1-y) × log(1-output)]
```

| 실제값 y | 예측 output | 손실 | 의미 |
|----------|-------------|------|------|
| 1 | 0.9 | 낮음 | 잘 예측함 |
| 1 | 0.1 | 높음 | 잘못 예측함 |
| 0 | 0.1 | 낮음 | 잘 예측함 |
| 0 | 0.9 | 높음 | 잘못 예측함 |

---

### 3. 학습의 목표

```
초기 상태:  w1, w2, w3, b = 랜덤값 → 예측 엉망 → 손실 높음
     ↓
   반복 학습
     ↓
최종 상태:  w1, w2, w3, b = 최적값 → 예측 정확 → 손실 낮음
```

이 과정이 "모델이 데이터를 학습한다"는 것입니다.

---

## 코드와 프로세스 매핑

| 프로세스 단계 | 코드 |
|---------------|------|
| 데이터 로드 | `CustomDataset("binary.csv")` |
| 데이터 분할 | `random_split(dataset, [train, val, test])` |
| 배치 생성 | `DataLoader(dataset, batch_size=64)` |
| 모델 정의 | `nn.Linear(3, 1)` + `nn.Sigmoid()` |
| 손실 함수 | `nn.BCELoss()` |
| 옵티마이저 | `optim.SGD(lr=0.0001)` |
| 순전파 | `output = model(x)` |
| 손실 계산 | `loss = criterion(output, y)` |
| 역전파 | `loss.backward()` |
| 가중치 업데이트 | `optimizer.step()` |
| 기울기 초기화 | `optimizer.zero_grad()` |
| 검증 | `model.eval()` + `torch.no_grad()` |
